<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf8"/>
<title>组合材质（传入材质数组,同时拥有多个材质样式）</title>
</head>

 <script type="text/javascript" src="../../js/jquery-1.7.1.js"></script>
<script type="text/javascript" src="../../js/three.js"></script>
<script type="text/javascript" src="../../js/SceneUtils.js"></script>
<script type="text/javascript" src="../../js/Stats.js"></script>
<script type="text/javascript" src="../../js/TrackballControls.js"></script>
<script type="text/javascript" src="../../js/dat.gui.js"></script>

<script type="text/javascript">
$(function(){
	var  version=THREE.REVISION;	
	$("#version").html("three版本:"+version);
})
</script>
<body>
<div>
<span id="version" style="position:relative;left:200px;top:2px;"></span></div>
<br/>
<div id="fps" style="position:relative;left:1500px;top:2px;">132</div>
<div id="div1"></div>
</body>
<script type="text/javascript">
//三大组件

var scene;//场景
var camera;//相机
var renderer;//渲染器
var axes;//坐标
//球形轨道控制器
var controls;
var stats;
var wuti_boj;//自定义物体
$(function(){
	 inits();//初始化组件
     add_plane();//平面
   //场景中添加元素
 	var cube_obj=add_cube();//立方体
 	var sphere_obj=add_sphere();//球体
 	var axes=add_axes();//坐标
 	
 	//add_spollight();//聚光灯
 	add_ambient();//环境光
 	aa_ArrowHelper();
 	add_directionallight();//平行光
     //自定义物体：
	 shc_start();//开始渲染
	 
})
//初始化组件：
function inits(){
	 //场景（所有图形存在的空间）
	 scene = new THREE.Scene();
	   // 透视相机
     camera = new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,0.1,1000);
     camera.position.set(-40,45,40);
     camera.lookAt(0,4,0);
	   // 渲染器
     renderer = new THREE.WebGLRenderer();
    // 设置渲染器的大小为窗口的内宽度，也就是内容区的宽度
    renderer.setClearColor(0xeeeeee);
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMapEnabled;
    renderer.shadowMapEnabled = true;
    //渲染器加入html
    $("#div1").append(renderer.domElement); 
    
    //添加坐标
    axes=new THREE.AxisHelper(20);
    scene.add(axes);
    //加入fps
	stats = new Stats();
    $("#fps").html(stats.dom);
}      
function shc_start(){
	 //渲染
    renderer.render(scene, camera);
  //animate();
}     
//动态函数
function animate(){
	//cube_mesh.opacity=Math.random();
    requestAnimationFrame(animate);
    renderer.render(scene,camera);

}

///&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&7
//添加物体方法	
//添加一条直线
function add_line(){
	  //首先，我们声明了一个几何体geometry，如下：
	   var geometry = new THREE.Geometry();
	   //定义一种线条的材质
	   var material = new THREE.LineLambertMaterial( { vertexColors: THREE.VertexColors } );
	   //定义2个顶点的位置，并放到几何体geometry中
	    var p1 = new THREE.Vector3( -100, 0, 100 );
		var p2 = new THREE.Vector3( 100, 0, -100 );
		geometry.vertices.push(p1);
		geometry.vertices.push(p2);
		//为定义的2个顶点，设置不同的颜色，代码如下所示：
		var color1 = new THREE.Color( 0x444444 ),
			color2 = new THREE.Color( 0xFF0000 );
		geometry.colors.push( color1, color2 );
		//、定义一条线
		var line = new THREE.Line( geometry, material, THREE.LinePieces );
		//将线条放入场景中
		scene.add(line);
		return line;
}
//添加一平面	
function add_plane(){
	var plane=new THREE.PlaneGeometry(100,60);
	var plane_mesh=new THREE.MeshLambertMaterial({color:"#9f9"});
	var plane_obj=new THREE.Mesh(plane,plane_mesh);
	plane_obj.rotation.x=-0.5*Math.PI;
	plane_obj.position.x=15;
	plane_obj.position.y=0;
	plane_obj.position.z=0;
	plane_obj.receiveShadow=true;//接受阴影
	scene.add(plane_obj);
	return plane_obj;
}
//添加一个立方体：P
var cube_mesh
function add_cube(){
	var cube=new THREE.CubeGeometry(4,4,4);
	 var cube_mesh = [
	        new THREE.MeshLambertMaterial({opacity: 0.8,color:"#f99",transparent:true}),
	        new THREE.MeshBasicMaterial({color:"#f99",wireframe:true}),
	    ]; 
	 var cube_obj = THREE.SceneUtils.createMultiMaterialObject(cube,cube_mesh);
	cube_obj.position.x=-4;
	cube_obj.position.y=3;
	cube_obj.position.z=0;
	cube_obj.castShadow=true;//允许阴影
	scene.add(cube_obj);
	return cube_obj;
}
//添加一个球体
function add_sphere(){
	var sphere=new THREE.SphereGeometry(4,20,20);
	 var sphere_mesh = [
	        new THREE.MeshLambertMaterial({opacity: 0.8,color:0x44e144,transparent:true}),
	        new THREE.MeshBasicMaterial({color:0x008800,wireframe:true}),
	    ]; 
	 var sphere_obj = THREE.SceneUtils.createMultiMaterialObject(sphere,sphere_mesh);
	sphere_obj.position.x=8;
	sphere_obj.position.y=12;
	sphere_obj.position.z=0;
	sphere_obj.castShadow=true;//允许阴影
	scene.add(sphere_obj);
	return sphere_obj;
}
//聚光灯：
function add_spollight(){
	var spotlight=new THREE.SpotLight("#000");
	spotlight.position.set(-40,60,-10);
	//spotlight.castShadow=true;//允许阴影
	scene.add(spotlight);
	return spotlight;
}
//方向光
function add_directionallight(){
	  var directionalLight = new THREE.DirectionalLight("#fff",0.5);
	  directionalLight.position.set(0,20,-10);
	  directionalLight.castShadow = true;
	  
	
	  directionalLight.shadow.camera.left = -20;
	  directionalLight.shadow.camera.right = 40;
	  directionalLight.shadow.camera.far = 50;
	  directionalLight.shadow.camera.top = 10;
	  
	/*   directionalLight.shadow.camera.near = 2;
	  directionalLight.shadow.camera.bottom = -30;
	  directionalLight.intensity = 0.5;
	  directionalLight.shadow.mapSize.width = 1024;
	  directionalLight.shadow.mapSize.height = 1024;  */
	  scene.add(directionalLight);
}
//添加环境光：
function add_ambient(){
	var ambientLight=new THREE.AmbientLight("#000");
	scene.add(ambientLight);
}
//添加坐标
function add_axes(){
	var axes=new THREE.AxisHelper(20);
	scene.add(axes);
	return axes;
}
//添加箭头
function aa_ArrowHelper(){
	var ve3_0=new THREE.Vector3(1,2,0);//决定箭头方向（需要格式化），方向为从0点到该点的方向；
	ve3_0.normalize();//规格化方向向量(转换为长度为1的向量)
	var ve3_1=new THREE.Vector3(1,1,0);//箭头起点
	var arrow=new THREE.ArrowHelper(
			ve3_0,//方向
			ve3_1,//起点
			10,//箭头线的先的长头
			"#f00",//箭头颜色
			4,//箭头的头的长度
			2,//箭头的头的宽度
	);
	scene.add(arrow);
}
</script>
</html>