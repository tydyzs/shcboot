<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf8"/>
<title>“随机属性的物体”添加到场景中</title>
</head>

<script type="text/javascript" src="../../js/jquery-1.7.1.js"></script>
<script type="text/javascript" src="../../js/three.js"></script>
<script type="text/javascript">
$(function(){
	var  version=THREE.REVISION;	
	$("#version").html(version);
})
</script>
<body>
当前版本：<span id="version"></span></br>
物体个数：<span id="counts"></span></br>
新增一批物体：<input type="button" value="添加" onclick="for_add()"/></br>
删除物体：cube<input id="nums" type="text" value="5"/><input type="button" value="删除" onclick="remove_cube()"/>
<div id="div1"></div>
</body>
<script type="text/javascript">
$(function(){
	initScene();//场景
	initThree();//渲染器
    initCamera();//相机
    //场景中添加元素
    var plane_obj=add_plane();//平面
	var spollight_obj=add_spollight();//光源
	for_add();//添加物体
	$("#counts").html(scene.children.length);//获取元素个数
	//开始渲染
    renderer.render(scene, camera);
	$("#div1").append(renderer.domElement);
})
function for_add(){
	for(var i=0;i<5;i++){
		addcube();//添加物体
	}
	renderer.render(scene, camera);
}
function remove_cube(){
	var name="cube-"+$("#nums").val();
	//var obj=scene.getChildByName(name);
	var obj=scene.getObjectByName(name);
	scene.remove(obj);
	renderer.render(scene, camera);
}
//&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
//场景
var scene;
function initScene() {
    scene = new THREE.Scene();
}
//渲染器
var renderer;
function initThree() {
	    renderer = new THREE.WebGLRenderer({
	        antialias : true
	    });
	 	// 设置渲染器的大小为窗口的内宽度，也就是内容区的宽度
	    renderer.setClearColor(0xeeeeee);
	    renderer.setSize(window.innerWidth, window.innerHeight);
	    renderer.shadowMapEnabled=true;//允许阴影
}
//照相机
var camera;
function initCamera() {
      camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 10000);
    	//相机设置
        camera.position.x=-30;
		camera.position.y=40;
		camera.position.z=30;
		camera.lookAt(0,5,0);  
		//camera.lookAt(scene.position);
}

///&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
//添加一平面	
function add_plane(){
	var plane=new THREE.PlaneGeometry(60,40);
	var plane_mesh=new THREE.MeshLambertMaterial({color:0xffffff});
	var plane_obj=new THREE.Mesh(plane,plane_mesh);
	plane_obj.rotation.x=-0.5*Math.PI;
	plane_obj.position.x=15;
	plane_obj.position.y=0;
	plane_obj.position.z=0;
	plane_obj.receiveShadow=true;//接受阴影
	scene.add(plane_obj);
	return plane_obj;
}
//场景中添加光源：
function add_spollight(){
	var spotlight=new THREE.SpotLight(0xffffff);
	spotlight.position.set(-40,60,-10);
	spotlight.castShadow=true;//允许阴影
	scene.add(spotlight);
	return spotlight;
}
//添加环境光：
function add_ambient(){
	var ambientLight=new THREE.AmbientLight(0x0c0c0c);
	scene.add(ambientLight);
}
function addcube(){
	var cubeSize=Math.ceil(Math.random()*5);
	var cube=new THREE.CubeGeometry(cubeSize,cubeSize,cubeSize);
	var cube_mesh=new THREE.MeshLambertMaterial({color:Math.random()*0xff0000});
	var cube_obj=new THREE.Mesh(cube,cube_mesh);
	cube_obj.name="cube-"+scene.children.length;
	//cube_obj.name="nametest";
	cube_obj.position.x=30*(Math.random());
	cube_obj.position.y=20*(Math.random());
	cube_obj.position.z=30*(Math.random());
	//角度
	cube_obj.rotateX(Math.random());   
	cube_obj.rotateY(Math.random());  
	cube_obj.rotateZ(Math.random()); 
	cube_obj.castShadow=true;//允许阴影
	scene.add(cube_obj);
	return cube_obj;
}
</script>
</html>